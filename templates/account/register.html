{% extends "base.html" %}
{% load static %}
{% if no_layout %}
    {% include "account/register_form.html" %}
{% else %}
    {% block title %}Create Account - WebChat{% endblock %}
    {% block content %}
        {% include "account/register_form.html" %}
    {% endblock %}
    {% block script %}
        <script>
            document.body.addEventListener("htmx:afterSwap", function (evt) {
                if (evt.detail.target.id === "otp-response") {
                    const msg = evt.detail.target.querySelector('.success-message');
                    if (msg) {
                        setTimeout(() => { msg.style.opacity = "0"; }, 4700);
                        setTimeout(() => { msg.remove(); }, 5100);
                    }
                }
            });

            function handleOtpClick(button) {
                const btnText = button.querySelector('.button-text');
                const spinner = button.querySelector('.spinner');
                button.disabled = true;
                btnText.textContent = "Sending...";
                spinner.style.display = 'inline-block';
                setTimeout(() => {
                    button.disabled = false;
                    btnText.textContent = "Send OTP";
                    spinner.style.display = 'none';
                }, 10000);
            }
        </script>
    {% endblock %}
{% endif %}
